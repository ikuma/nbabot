# AI Policy (Common)

この文書は、複数のコーディングエージェントで共通適用する運用ポリシーです。

## 優先順位

1. `CLAUDE.md` (憲法 / 最優先)
2. `docs/AI_POLICY.md` (共通ルール)
3. `AGENTS.md` / `CLAUDE.md` の各エージェント向け補足
4. `docs/AI_RUNBOOK.md` (実行コマンド・手順)

矛盾時は上位文書を優先する。

## 共通ルール

- 応答は日本語で行う（コードコメント・docstring は規約に従い英語可）。
- 原則、質問より実行を優先する。曖昧さは妥当な仮定を置いて前進する。
- 変更は最小差分で行い、無関係な差分や既存変更を巻き戻さない。
- 依存追加・設定大改修・広範囲リファクタは、着手前に狙いと影響範囲を明示する。
- `.env`、秘密鍵、APIキーなど機微情報は出力・コミットしない。

## 停止して確認する条件

以下に該当する場合のみ、実装を止めて確認を取る。

- 破壊的変更（データ削除、履歴破壊、不可逆マイグレーション）
- 外部公開影響（本番デプロイ、外部連携仕様変更）
- 新規依存追加や大きな方針転換
- ユーザー要件が競合して安全に仮定できない場合

## 実装・検証の標準フロー

1. 現状把握（関連ファイル、既存テスト、既存パターン）
2. 小さく実装（差分意図を明確化）
3. 可能な範囲でテスト実行
4. 結果要約（変更ファイル、理由、検証結果、次アクション）

## Git運用

- 勝手な `revert` をしない。
- `git reset --hard` など破壊的操作は明示指示がある場合のみ。
- コミットは Conventional Commits を基本とする。
